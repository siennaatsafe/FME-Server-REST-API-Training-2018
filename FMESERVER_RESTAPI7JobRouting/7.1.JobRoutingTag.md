### 7.1 Creating a Routing Tag

<table style="border-spacing: 0px;border-collapse: collapse;font-family:serif">
<tr>
<td width=25% style="vertical-align:middle;background-color:darkorange;border: 2px solid darkorange">
<i class="fa fa-cogs fa-lg fa-pull-left fa-fw" style="color:white;padding-right: 12px;vertical-align:text-top"></i>
<span style="color:white;font-size:x-large;font-weight: bold">Exercise 11 </span>
</td>
<td style="border: 2px solid darkorange;background-color:darkorange;color:white">
<span style="color:white;font-size:x-large;font-weight: bold"> Creating a routing tag</span>
</td>
</tr>

<tr>
<td style="border: 1px solid darkorange; font-weight: bold">Data</td>
<td style="border: 1px solid darkorange">None</td>
</tr>

<tr>
<td style="border: 1px solid darkorange; font-weight: bold">Overall Goal</td>
<td style="border: 1px solid darkorange">  </td>
</tr>

<tr>
<td style="border: 1px solid darkorange; font-weight: bold">Demonstrates</td>
<td style="border: 1px solid darkorange"> </td>
</tr>
<tr>
<td style="border: 1px solid darkorange; font-weight: bold">Workspace</td>
<td style="border: 1px solid darkorange"> </td>
</tr>


</table>

The following call allows you to create a new tag for a job. The follow
tag created will be called High\_Priority. Any jobs with this tag will
be sent to localhost\_Engine1. You may a tag to multiple engines.

**Request**

    POST https://YOURSERVER/fmerest/v3/transformations/jobroutes/tags

    Content-Type: application/x-www-form-urlencoded
    Accept: application/json
    Authorization: fmetoken token= [INSERT TOKEN HERE]

    engines=localhost_Engine1&name=High_priority


**Parameters**

<table>

<tr>
<th>Parameter</th>
<th>Description</th>

</tr>

<tr>
<td>description</td>
<td>Description of the tag</td>

<tr>
<td>engines</td>
<td>Engine assignment for the tag
</td>

<tr>
<td>name</td>
<td>Required- Unique name of the tag to create</td>

<tr>
<td>repositories</td>
<td>Repository assignments for the tag</td>

<tr>
<td>priority</td>
<td>Priority for the tag. Priority values must be integers between 1 and 200. If a tag's priority value is less than 1, greater than 200, or is not specified, then FME Server sets it to 100.</td>

</tr>

</table>


**Response**


     201- Success. The tag was created.


**Assigning a Repository to the Routing Tag**

**Request**

    POST http://YOURSERVER/fmerest/v3/transformations/jobroutes/tags/High_priority/repositories

    Content-Type: application/x-www-form-urlencoded
    Accept: application/json

    repositories=Samples


**Parameters**

<table>

<tr>
<th>Parameter</th>
<th>Description</th>

</tr>

<tr>
<td>repositories</td>
<td>Repository assignments for the tag</td>

<tr>
<td>tag</td>
<td>Name of a job routing tag
</td>



</tr>

</table>


**Response**


    204- Success. The assigned repositories were assigned.


**Submit a Job and Include the Tag in the Request**

When you submit a job. You may specify the tag in the request, under the
TMDirectives. The TMDirectives specify how the job should be run by the
server. Below is the full list of parameters.

    TMDirectives {

    rtc (boolean, optional): Runs a job until it is explicitly canceled. The job will run again regardless of whether the job completed successfully, failed, or the server crashed or was shut down.,

    ttc (integer, optional): Time (in seconds) elapsed for a running job before it's canceled. The minimum value is 1 second, values less than 1 second are ignored.,

    ttl (integer, optional): Time to live in the job queue (in seconds),
    description (string, optional): Description of the request,

    priority (integer, optional): The priority of the job. Priority values must be integers between 1 and 200. If a request's priority value is less than 1, greater than 200, or is not specified, then FME Server sets it to 100.,

    tag (string, optional): The job routing tag for the request
    }


So in the body of the submit the TMDirectives would look like this:

    "TMDirectives": {
        "rtc": false,
        "ttc": 60,
        "description": "This is my description",
        "tag": "linux",
        "priority": 5,
        "ttl": 60
      },

A submit call with just the tag specified would look like this:

    POST http://YOURSERVER/fmerest/v3/transformations/submit/Samples/austinDownload.fmw

    Content-Type: application/json
    Accept: application/json


    {
      "publishedParameters": [
        {
          "name": "MAXY",
          "value": "42"
        },
        {
          "name": "THEMES",
          "value": [
            "airports",
            "cenart"
          ]
        }
      ],
      "TMDirectives": {
        "tag": "High_priority"

      }
    }


**Response**

    {

    "id": 90

    }

Now we can check the job to see if the job ran successfully under the
High\_priority tag.


    GET http://YOURSERVER/fmerest/v3/transformations/jobs/id/90\

    Accept: application/json



In the response, you can find the Engine that the call was submitted to
and the parameters of the call.
